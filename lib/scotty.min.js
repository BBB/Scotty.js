/*
* Scotty.js
* version: 0.1
* URL: http://github.com/BBB/scotty.js
* Description: A window.location.hash kvp system
* Author: Ollie Relph http://ollie.relph.me/ || ollie@relph.me
*/
var Scotty=function(a){this.fromString(a);return this};
Scotty.prototype={keyStore:{},_listeners:{},_triggerListeners:function(a,b){for(var c in this._listeners[a])this._listeners[a][c].apply(null,[b]);if(this._listeners.hasOwnProperty("*"))for(c in this._listeners["*"])this._listeners["*"][c].apply(null,[b])},_hasChanged:function(a,b){return this.keyStore[a]!=encodeURIComponent(b)},setValue:function(a,b){if(""==a||""==b||"undefined"==b||!this._hasChanged(a,b))return!1;this.keyStore[a]=b;this._triggerListeners(a,b);return!0},setValues:function(a){for(var b in a)this._hasChanged(b,
a[b])&&(this.keyStore[b]=encodeURIComponent(a[b]),this._triggerListeners(b,a[b]))},fromString:function(a){-1<a.indexOf("?")&&(a=a.split("?")[1]);var a=a.split("&"),b;for(b in a)b=a[b].split("="),this.setValue(b[0],b[1])},toString:function(){var a="#/?",b;for(b in this.keyStore)this.keyStore.hasOwnProperty(b)&&(1<a.length&&(a+="&"),a+=b+"="+this.keyStore[b]);return window.location.protocol+'//'+window.location.host+window.location.pathname+a;},addListener:function(a,b){this._listeners.hasOwnProperty(a)?this._listeners[a].push(b):
this._listeners[a]=[b]},getValue:function(a){return decodeURIComponent(this.keyStore[a])}};